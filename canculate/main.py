import torch
import sys
param1= [torch.tensor([[[-0.0451, -0.1379,  0.0010],
         [ 0.0882,  0.1006,  0.2131],
         [-0.0808,  0.0402, -0.0330],
         [-0.2393,  0.0148, -0.0791]],

        [[ 0.0868, -0.0391,  0.1715],
         [ 0.1478, -0.1493, -0.0192],
         [ 0.1374,  0.1298,  0.1658],
         [-0.1070,  0.1989,  0.1983]],

        [[ 0.3491, -0.0268,  0.2567],
         [-0.1071,  0.1814,  0.1738],
         [ 0.3640, -0.2401,  0.1972],
         [ 0.0956, -0.1262,  0.1262]],

        [[ 0.1787,  0.0649,  0.1938],
         [ 0.1382, -0.0365,  0.1775],
         [-0.0306,  0.0508,  0.0753],
         [ 0.3606, -0.0655, -0.0606]],

        [[ 0.0960,  0.2604,  0.1213],
         [ 0.0835,  0.2069,  0.1940],
         [ 0.1732, -0.1439,  0.2581],
         [ 0.3004,  0.2569,  0.0869]],

        [[-0.1072, -0.0211, -0.1040],
         [ 0.2248,  0.1471, -0.0717],
         [ 0.0607,  0.1697, -0.0760],
         [ 0.0599,  0.1604,  0.0645]]], requires_grad=True), torch.tensor([[[ 0.0484, -0.1360,  0.2202],
         [-0.0426,  0.2383, -0.0138],
         [-0.0539, -0.2233, -0.2295],
         [ 0.0689,  0.2239,  0.2997]],

        [[-0.0717, -0.0993, -0.0171],
         [-0.0670, -0.0026,  0.0140],
         [ 0.1163,  0.0306,  0.0087],
         [-0.1778, -0.0495, -0.2159]],

        [[-0.0539,  0.0575, -0.1091],
         [ 0.0747, -0.0176,  0.0543],
         [-0.1580, -0.1470, -0.2604],
         [ 0.0335,  0.0302, -0.1916]],

        [[ 0.1051,  0.0855,  0.1582],
         [ 0.0476,  0.2894,  0.2050],
         [ 0.1838, -0.0692,  0.1681],
         [ 0.1080, -0.0138,  0.1248]],

        [[ 0.3498,  0.2452, -0.0691],
         [-0.2343, -0.1980, -0.1885],
         [ 0.4738,  0.2099,  0.3017],
         [-0.3022, -0.1267, -0.2289]],

        [[ 0.0949, -0.0383,  0.0710],
         [ 0.0249,  0.1219,  0.0201],
         [ 0.1021,  0.1014, -0.0325],
         [ 0.0048, -0.1611, -0.1386]]], requires_grad=True)]
bias1=[torch.tensor([0.1409], requires_grad=True), torch.tensor([0.0590], requires_grad=True)]

param2 = [torch.tensor([[[ 0.0018, -0.1583,  0.0353],
         [ 0.0463,  0.0114,  0.1667],
         [-0.0182, -0.1741,  0.0213],
         [-0.1721, -0.0687, -0.0353]],

        [[ 0.1669, -0.1105,  0.2593],
         [ 0.1116, -0.0264, -0.0501],
         [ 0.1321,  0.1279,  0.1514],
         [ 0.0723,  0.0985,  0.3995]],

        [[ 0.3053,  0.0027,  0.2142],
         [-0.0702,  0.2532,  0.2106],
         [ 0.2567, -0.1487,  0.1015],
         [ 0.1839, -0.0892,  0.2153]],

        [[ 0.1680,  0.0461,  0.1821],
         [ 0.2035,  0.0271,  0.2660],
         [-0.0344,  0.0643,  0.0688],
         [ 0.4225, -0.0300, -0.0020]],

        [[ 0.1590,  0.2101,  0.1774],
         [ 0.1337,  0.1016,  0.1226],
         [ 0.2286, -0.1878,  0.2935],
         [ 0.2908,  0.2065,  0.2512]],

        [[-0.1088, -0.0141, -0.1053],
         [ 0.2089,  0.1673, -0.0744],
         [-0.0096,  0.0643, -0.0748],
         [ 0.0278,  0.0412,  0.0615]]], requires_grad=True), torch.tensor([[[-0.0123, -0.1575,  0.2204],
         [-0.0235,  0.2363,  0.0322],
         [-0.1264, -0.0454, -0.2788],
         [-0.0816,  0.2561,  0.1195]],

        [[-0.2052, -0.0318, -0.1295],
         [-0.0294, -0.0163,  0.0448],
         [ 0.1417,  0.0383,  0.0212],
         [-0.3273, -0.1306, -0.3558]],

        [[-0.1486, -0.1673, -0.1882],
         [ 0.0896, -0.0638,  0.0606],
         [-0.1943, -0.1776, -0.2367],
         [-0.0693,  0.0323, -0.3092]],

        [[ 0.1239,  0.1415,  0.1686],
         [ 0.0585,  0.2460,  0.2092],
         [ 0.1410, -0.1087,  0.1270],
         [ 0.0235, -0.1202,  0.0121]],

        [[ 0.3288,  0.2827, -0.0675],
         [-0.3691, -0.2006, -0.0016],
         [ 0.3677,  0.0803,  0.2099],
         [-0.0520, -0.1684, -0.1627]],

        [[ 0.0964, -0.0420,  0.0728],
         [ 0.0803,  0.1567,  0.0170],
         [-0.0333,  0.0197, -0.0321],
         [-0.0561, -0.1179, -0.1382]]], requires_grad=True)]
bias2=[torch.tensor([0.1227], requires_grad=True), torch.tensor([0.0772], requires_grad=True)]

param3= [torch.tensor([[[ 0.0168, -0.1567,  0.0537],
         [ 0.0694,  0.1428,  0.1928],
         [-0.0442, -0.0271,  0.0033],
         [-0.1946, -0.0547, -0.0354]],

        [[ 0.1042, -0.1739,  0.2021],
         [ 0.1346, -0.1686, -0.0204],
         [ 0.1123,  0.1207,  0.1380],
         [-0.0167,  0.1803,  0.2974]],

        [[ 0.2822,  0.0327,  0.1909],
         [-0.0877,  0.2899,  0.2080],
         [ 0.2370, -0.2011,  0.0942],
         [ 0.1467, -0.0993,  0.1744]],

        [[ 0.1690,  0.0193,  0.1824],
         [ 0.1233, -0.0366,  0.1599],
         [-0.0273, -0.0235,  0.0790],
         [ 0.4342, -0.0598,  0.0066]],

        [[ 0.1652,  0.2523,  0.2005],
         [ 0.1116,  0.1133,  0.1475],
         [ 0.1816, -0.2389,  0.2616],
         [ 0.3445,  0.3040,  0.1330]],

        [[-0.1085, -0.0234, -0.1052],
         [ 0.1674,  0.1189, -0.0731],
         [-0.0471,  0.1377, -0.0748],
         [ 0.0137,  0.0511,  0.0632]]], requires_grad=True), torch.tensor([[[-0.0320, -0.1577,  0.1855],
         [ 0.0117,  0.1714,  0.0555],
         [-0.0766, -0.1849, -0.2440],
         [ 0.0253,  0.2284,  0.2454]],

        [[-0.1401, -0.0778, -0.0774],
         [-0.0076, -0.0542,  0.0721],
         [ 0.1491,  0.0418,  0.0458],
         [-0.2573, -0.1299, -0.2926]],

        [[-0.1042, -0.0878, -0.1222],
         [ 0.2022, -0.0486,  0.1805],
         [-0.1738, -0.1790, -0.2484],
         [-0.0024,  0.0384, -0.2260]],

        [[ 0.1391,  0.0160,  0.1931],
         [ 0.0841,  0.2863,  0.2334],
         [ 0.2036, -0.1227,  0.1851],
         [ 0.0580, -0.1189,  0.0757]],

        [[ 0.3636,  0.2402, -0.0336],
         [-0.3358, -0.2670, -0.1066],
         [ 0.4344,  0.1874,  0.2642],
         [-0.1712, -0.2032, -0.1249]],

        [[ 0.0968, -0.0279,  0.0728],
         [ 0.0458,  0.0989,  0.0175],
         [ 0.0542,  0.0643, -0.0317],
         [-0.0824, -0.0754, -0.1350]]], requires_grad=True)]
bias3= [torch.tensor([0.1270], requires_grad=True), torch.tensor([0.0729], requires_grad=True)]
param4 = [torch.tensor([[[ 0.0419, -0.1630,  0.0468],
         [ 0.1264,  0.0913,  0.2452],
         [-0.0255, -0.0820,  0.0279],
         [-0.2039, -0.0545, -0.0447]],

        [[ 0.1607, -0.1827,  0.2540],
         [ 0.1885, -0.1695,  0.0344],
         [ 0.1004,  0.1431,  0.1268],
         [ 0.0356,  0.1517,  0.3470]],

        [[ 0.2757, -0.0029,  0.1840],
         [-0.0897,  0.2702,  0.1736],
         [ 0.2423, -0.2321,  0.1037],
         [ 0.1498, -0.1341,  0.1797]],

        [[ 0.1771,  0.0162,  0.1897],
         [ 0.0984, -0.0937,  0.1359],
         [-0.0666, -0.0204,  0.0401],
         [ 0.4271, -0.1539,  0.0025]],

        [[ 0.1807,  0.2118,  0.1929],
         [ 0.1240,  0.0642,  0.1745],
         [ 0.1623, -0.2312,  0.2444],
         [ 0.3017,  0.3282,  0.0778]],

        [[-0.1185, -0.0317, -0.1152],
         [ 0.1410,  0.1596, -0.0730],
         [-0.0350,  0.1165, -0.0738],
         [ 0.0386,  0.0421,  0.0624]]], requires_grad=True), torch.tensor([[[-0.0397, -0.1796,  0.0369],
         [-0.0151,  0.2226,  0.0579],
         [-0.0953, -0.1158, -0.2780],
         [ 0.1224,  0.2490,  0.3338]],

        [[-0.1793, -0.0832, -0.1192],
         [-0.0007, -0.0788,  0.0766],
         [ 0.1612,  0.0131,  0.0558],
         [-0.2990, -0.0860, -0.3405]],

        [[-0.0943, -0.0362, -0.1016],
         [ 0.1728, -0.0106,  0.1138],
         [-0.1434, -0.1725, -0.2034],
         [-0.0432,  0.0619, -0.2664]],

        [[ 0.1211,  0.0493,  0.1752],
         [ 0.0979,  0.2682,  0.2392],
         [ 0.2072, -0.1063,  0.1800],
         [ 0.1227, -0.0862,  0.1682]],

        [[ 0.3325,  0.2245, -0.0466],
         [-0.3420, -0.2453, -0.0887],
         [ 0.5198,  0.1684,  0.3406],
         [-0.2234, -0.1892, -0.2159]],

        [[ 0.0987, -0.0379,  0.0751],
         [ 0.0301,  0.0634,  0.0162],
         [ 0.0094,  0.0482, -0.0316],
         [ 0.0123, -0.1314, -0.1400]]], requires_grad=True)]
bias4=[torch.tensor([0.1116], requires_grad=True), torch.tensor([0.0883], requires_grad=True)]
res_param=[]
for i in range(2):
      t=(param1[i]+param2[i]+param3[i]+param4[i])/4
      res_param.append(t)
params_path = "param.txt"
print("------------------------Write Params-----------------------------")
__console = sys.stdout
fp = open(params_path, "a+")
sys.stdout = fp
print("---------------------------weights-------------------------------")
print(res_param)
sys.stdout = __console
res_bias=[]

for i in range(2):
      t=(bias1[i]+bias2[i]+bias3[i]+bias4[i])/4
      res_bias.append(t)

print("------------------------Write Params-----------------------------")
__console = sys.stdout
fp = open(params_path, "a+")
sys.stdout = fp
print("---------------------------bias-------------------------------")
print(res_bias)
sys.stdout = __console